<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Admin Password</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="toast-container"></div>
    <div class="container" style="max-width: 400px; margin-top: 100px;">
        <div class="card">
            <h2><i class="fas fa-key"></i> Reset Password</h2>
            <p style="font-size: 0.8rem; color: gray; margin-bottom: 20px;">
                Enter your Master Recovery Code to set a new password.
            </p>

            <label>Master Recovery Code</label>
            <input type="password" id="recoveryCode" placeholder="Enter Secret Code">

            <label>New Admin Password</label>
            <input type="password" id="newPass" placeholder="Enter New Password">

            <button onclick="handleReset()" id="resetBtn">Update Password</button>
            <br>
            <a href="login.html" style="font-size: 0.8rem; color: #10b981;">Back to Login</a>
        </div>
    </div>

    <script>
        async function handleReset() {
            const recoveryCode = document.getElementById('recoveryCode').value;
            const newPassword = document.getElementById('newPass').value;

            if(!recoveryCode || !newPassword) return alert("Please fill all fields");

            const res = await fetch('http://localhost:5000/api/users/reset-admin-password', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ recoveryCode, newPassword })
            });

            const result = await res.json();

            if (result.success) {
                alert("✅ Success! Your new password is set.");
                window.location.href = 'login.html';
            } else {
                alert("❌ Error: " + result.message);
            }
        }
    </script>
</body>
</html>